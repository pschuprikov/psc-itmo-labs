\section{Существующие методы}
Визуализация водной поверхности прибрежных районов водной поверхности не раз оказывалась предметом
работ по компьютерной графике. Актуальность этой темы не вызывает сомнений, редкие приложения 
виртуальной реальности предоставляют открытую местность, лишенную водоемов, и еще более 
редкие приложения используют лишь водную поверхность без суши. Геометрические модели
открытой воды были разработаны и успешно применены еще в конце прошлого столетия (фильм \emph{Титаник}).
Поведение же воды вблизи берега, где существенное влияние оказывает рельеф дна, все еще представляет 
сложность для приложений реального времени. 

Несмотря на то, что в данной работе не рассматривается
модификация геометрии, стоит упомянуть статью Гонзато и др. \cite{refraction}, в которой используется
интересная параллель между путем, проходимым световым пучком в неоднородной среде, и путем, который 
проходит некоторая часть фронта морской волны при движении по меняющемуся рельефу дна. Тем не менее, этот
метод достаточно вычислительно дорог и требует перерасчета при каждом изменении направлении ветра, что
делает его в любом случае неприемлимым для решения поставленной задачи.

Существуют различные методы моделирования приливных волн или сопутствующих эффектов, которые 
используются в современных приложениях реального времени. Данные методы предлагается разделить на три
основные категории и описать каждую отдельно:
\begin{itemize}
\item методы, использующие данные, полученные из геометрической модели водной поверхности;
\item методы, использующие статическую информацию об эффектах в заданной точке поверхности;
\item методы, использующие карту расстояний (англ.~distance map) до берега или сходные структуры.
\end{itemize}

Рассмотрим каждый из методов подробнее, подчеркнем основные достоинства и недостатки. В конце раздела
приводится метод визуализации наката приливной волны на берег.

\subsection{Методы, основанные на геометрической модели}
Обратимся вновь к работе \cite{tessendorf}. В качестве основной геометрической модели в работе 
используется статистическая модель с известным математическим ожиданием спектра 
(спектр Филлипса, англ.~Phillips spectrum). 

Использование чистого преобразование Фурье приводит
к слишком гладким волновым гребням, хотя в неспокойных погодных условиях мы часто можем наблюдать
прерывистую форму волн, которые могут сужаться и расширяться. Для достижения данного эффекта
используется дополнительное горизонтальное смещение имеющегося поля высот, в каждой в точке поверхности
разное.  Если говорить кратко, то точки на водной поверхности, расположенные выше сближаются, 
ниже --- отдаляются. Когда точки сильно сближаются, то наклон волны возрастает и в данном месте волны 
вероятно <<опрокидование>> гребня, появление пены и прочие эффекты.

Таким образом данный метод позволяет, исходя из геометрической модели, определить возможные 
точки возникновения пены, отследить <<опрокидывающиеся>> гребни и прочее.

Одним из явных достоинств данного метода является отсутствие дополнительных 
структур данных для реалистичной визуализации прибоя и образующейся пены. Вместе с тем этот метод
по-построению синхронизирован с геометрической моделью, даже такой непредсказуемой, как статистическая 
спектральная модель. Метод легко можно совместить с имеющейся в инфраструктуре геометрической моделью,
поскольку она, по сути, является упрощением статистической спектральной модели.

К сожалению статистические модели не позволяют учитывать что-либо, кроме 
статистической модели. А без учета рельефа дна, или хотя бы, относительного расположения береговой линии,
невозможно вести речь о приливных волнах.

Предположительно, в игре \emph{Assasin's Creed III} (см. статью \cite{ac3}) при визуализации
открытого моря используется схожая техника.

\subsection{Методы, использующие статическую информацию}
Данный метод можно считать наиболее простым с точки зрения программиста компьютерной графики,
однако, он значительно усложняет жизнь художниками и дизайнерам уровней. Заключается он в следующем:
для визуализации прибоя, пены и прочих эффектов на стадии предварительной обработки создаются
вспомогательные текстуры (двумерные карты), содержащие информацию об интенсивности (или о любой другой необходимой
характеристике) эффекта в данной точке поверхности.
Выделим основные способы создания подобных текстур:
\begin{itemize}
\item дизайнеры уровней самостоятельно рисуют текстуры;
\item к геометрии ландшафта применяются определенные фильтры, и на выходе имеются требуемые текстуры;
\item комбинация первых двух, автоматическая генерация с последующей коррекцией дизайнерами.
\end{itemize} 
Второй способ также находит свое применение в уже упоминавшейся статье~\cite{ac3}.

Есть еще один способ, который менее требователен к памяти, требует меньше (в случае использования шума
не требует вовсе)
труда дизайнеров, однако также
обладает рядом недостатков, --- это использование техники \emph{замощения} (англ.~tiling). 
При использовании данного способа одна или несколько небольших текстура повторяются на всю площадь и
тем или иным образом комбинируются.

Основным достоинством данного метода является простота реализации, достаточно
при визуализации воды обратиться в соответствующую текстуру и на основании полученных данных
применить эффект. В случае с использованием \emph{замощения} метод не требователен к графической памяти.

Недостатком использования глобальных текстур является их неподъемный размер.
При территориях размера порядка десятков километров, сохранить все текстуры в графической памяти 
не представляется возможным, поэтому необходимо разбивать огромные текстуры на кусочки и подгружать
их по требованию, что создает дополнительную нагрузку на графическую и оперативную память 
(в присутствии \emph{Direct Memory Access}, нагрузка на процессор незначительна) и сложность 
реализации если выполнять подгрузку асинхронно с основным потоком исполнения. Метод с 
замощением может привести к другому ряду проблем, таких как:
\begin{itemize}
\item бросающиеся в глаза тайлы (повторяющиеся кусочки текстуры);
\item невозможность ориентировать анимацию текстур по направлению к берегу.
\end{itemize}

\subsection{Методы, использующие карту растояний}
Наконец мы подошли к наиболее часто используемому методу, который действительно можно использовать для
решения поставленной задачи. Итак, как следует из названия, основу метода составляет карта расстояний
до берега. Т. е. на этапе предварительной обработки каждой точке на водной поверхности ставится в 
соответствие расстояние от нее до ближайшей точки на береговой линии. 

Имея в распоряжении подобную карту расстояний $d(x,y)$, можно создать эффект, параметризованный $u = d(x, y) - vt$, 
где $t$ --- время. Данный эффект имеет эквипотенциальную поверхность, совпадающую с эквидистами,
до берега и при изменении $t$ анимируется в направлении к берегу.

В качестве примера подобных эффектов можно привести реализацию приливных волн в движке \emph{outerra}, 
описанную в работе \cite{outera}. В ней (работе) параметр, описанный выше подставляется в уравнение волн
Герстнера, образую направленную к берегу волну, которая имеет предсказуемое поведение и легко
поддается таким модификациям, как добавление <<барашков>>, пены и других эффектов, включая мокрый песок.
Другим примером реализации данного метода может послужить статья, написанная разработчиками игры 
Skyforge \cite{skyforge}.

Полезно отметить, что в обоих статьях применяется вспомогательная структура --- поле направлений на 
берег, являющееся по сути градиентом поля расстояний. Эта структура используется для модификации 
геометрии волн, таких как наклон гребней по направлению к берегу.

\subsection{Накат волны на берег и эффект <<мокрого песка>>}
Разработчики Skyforge \cite{skyforge} предложили следующий метод создания эффекта мокрого песка и смешивание его с 
накатывающими волнами: вблизи берега поверхность воды приподнимается над ландшафтом и при визуализации
воды применяются необходимые модификаторы освещения к нижележащему песку. В частности, песок затемняется
и к нему добавляются блики. Далее в рамках одной визуализации несложно рассчитать коэффициенты смешения обоих эффектов 
(пены прибоя и мокрого песок).
