\section{Существующие методы}
Визуализация водной поверхности в прибрежных районах не раз оказывалась темой
работ по компьютерной графике. Актуальность этой области не вызывает сомнений, редкие приложения 
виртуальной реальности визуализируют открытый ландшафт, лишенный водоемов, и еще более 
редкие приложения --- водную поверхность без ландшафта. Геометрические модели
открытой воды были разработаны и успешно применены еще в прошлом столетия (фильм \emph{Титаник}).
Визуализация поведения воды вблизи берега, где на нее существенное влияние оказывает рельеф дна, 
все еще представляет проблему для приложений реального времени. 

Несмотря на то, что в данной работе не рассматривается изменение геометрии водной поверхности, 
стоит упомянуть статью Гонзато и др. \cite{refraction}, в которой проводиться
интересная параллель между путем, проходимым световым пучком в неоднородной среде, 
и путем, проходимым некоторой точкой фронта морской волны при движении по меняющемуся рельефу дна. 
Этот метод требует большого количества вычислений дорог, которые необходимо повторять при каждом 
изменении направлении ветра, что делает его, в любом случае, неприменимым для решения 
поставленной задачи.

Существуют различные методы моделирования приливных волн и сопутствующих эффектов, которые 
используются в современных приложениях компьютерной графики реального времени. Данные методы 
предлагается разделить на три основные категории:
\begin{itemize}
\item методы, использующие геометрическую модель водной поверхности;
\item методы, использующие статическую информацию об эффектах в заданной точке поверхности;
\item методы, использующие карту расстояний (англ.~distance map) до берега или сходные структуры данных.
\end{itemize}

Далее метод рассматривается подробнее, подчеркиваются его основные достоинства и недостатки.

\subsection{Методы, основанные на геометрической модели}
Обратимся вновь к работе \cite{tessendorf}. В ней в качестве основной геометрической модели
используется статистическая модель с известным математическим ожиданием спектра 
(спектр Филлипса, англ.~Phillips spectrum) и прямое преобразование Фурье. 

Чистое преобразование спектра приводит к слишком гладким волновым гребням в то время, как в 
сложных погодных условиях часто можно наблюдать прерывистую форму накатывающих друг на друга волн. 
Для достижения данного эффекта используется дополнительное горизонтальное смещение имеющегося 
поля высот, при этом величины смещения в каждой точке разная.  Если кратко, то точки на водной 
поверхности, расположенные выше сближаются, ниже --- отдаляются. В ситуации сильного сближения, наклон волны возрастает 
и весьма вероятно обрушение гребня, появление пены и брызг.

Таким образом данный метод позволяет, исходя из геометрической модели, определить возможные 
точки возникновения пены, отследить гребни и так далее.

Одним из явных достоинств данного метода является отсутствие дополнительных 
структур данных для визуализации прибоя и образующейся пены. Вместе с тем этот метод
по построению соответствует геометрической модели, даже такой непредсказуемой, 
как статистическая спектральная модель. Его легко можно совместить с имеющейся в инфраструктуре 
геометрической моделью, являющейся, по сути, также преобразованием Фурье.

К сожалению статистические модели не позволяют учитывать что-либо, кроме 
статистической модели. А без учета рельефа дна, или хотя бы, относительного 
расположения береговой линии, невозможна прибрежных волн.

Предположительно, в игре \emph{Assasin's Creed III} (см. статью \cite{ac3}) при визуализации
открытого моря используется подобный метод.

\subsection{Методы, использующие статическую информацию}
Данный метод можно считать наиболее простым с точки зрения реализации,
однако, он значительно усложняет жизнь художниками и дизайнерам уровней. Заключается 
метод в следующем: для визуализации прибоя, пены и прочих эффектов на стадии предварительной 
обработки создаются вспомогательные текстуры (двумерные массивы), содержащие информацию об 
интенсивности (или о любой другой необходимой характеристике) эффекта в точке поверхности, 
соответствующей конкретному текселю (элементу двумерного массива).

Выделим основные способы создания подобных текстур:
\begin{itemize}
\item дизайнеры уровней самостоятельно рисуют текстуры;
\item к геометрии ландшафта применяются определенные фильтры, результатом которых являются 
требуемые текстуры;
\item комбинация первых двух: автоматическая генерация с последующей ручной коррекцией.
\end{itemize} 
Второй способ также находит свое применение в уже упоминавшейся работе ~\cite{ac3}.

Обособлено стоит способ, который менее требователен к памяти, 
требует меньше (в случае использования шумов не требует вовсе) труда дизайнеров, однако также
обладает рядом недостатков. Данный метод называется \emph{замощением} (англ.~tiling), и 
заключается в том, что одна или несколько небольших текстур повторяются на всю площадь эффекта и
каким-то образом комбинируются.

Основным достоинством данного метода является простота реализации. 
В случае \emph{замощения} достоинством также является малый объем графической памяти,
требуемой для реализации метода.

Недостатком использования глобальных текстур является их неподъемный размер.
При территориях размера порядка десятков километров, сохранить все текстуры в графической памяти 
не представляется возможным, поэтому необходимо разбивать огромные текстуры на кусочки и подгружать
их по требованию, что создает дополнительную нагрузку на графическую и оперативную память 
(в присутствии \emph{Direct Memory Access}, нагрузка на процессор незначительна). 
Дополнительную сложность вызывают оптимизации, с выполнением подгрузки асинхронно с 
основным потоком исполнения. 

Недостатками методов, использующих замощение, являются:
\begin{itemize}
\item бросающиеся в глаза тайлы (повторяющиеся кусочки текстуры);
\item оставленный открытым вопрос анимации.
\end{itemize}

\subsection{Методы, использующие карту расстояний}
Наконец мы подошли к наиболее часто используемому методу, который в целом подходит для
решения поставленной задачи, но имеет ряд недостатков. Итак, как следует из названия, 
основу метода составляет карта расстояний до берега. Т. е. на этапе предварительной обработки 
каждой точке на водной поверхности ставится в соответствие расстояние от нее до ближайшей 
точки на береговой линии. Обзор методов, применяемых для решения поставленной задачи
можно найти в \cite{dtsurvey}.

Имея в распоряжении подобную карту расстояний $d(x,y)$, можно создать эффект, параметризованный 
$u = d(x, y) - vt$, где $t$ --- время. Данный эффект имеет эквипотенциальную поверхность,
совпадающую с множеством точек, равноудаленных от берега и при изменении 
$t$ эффект плавно смещается по направлению к берегу.

В качестве примера подобных эффектов можно привести реализацию приливных волн в движке 
\emph{outerra}, описанную в работе \cite{outerra}. В ней параметр, описанный выше подставляется 
в уравнение волн Герстнера, образую направленную к берегу волну, которая имеет предсказуемое 
поведение и легко поддается таким модификациям, как добавление <<барашков>>, пены, опрокидыванию гребней, и других эффектов,
включая мокрый песок. Другим примером реализации данного метода может 
послужить статья в блоге разработчиков игры Skyforge \cite{skyforge}.

В обоих работах применяется вспомогательная структура --- поле направлений на 
берег, являющееся градиентом поля расстояний. Эта структура используется для таких модификаций
геометрии волн, как наклон гребней по направлению к берегу.

\subsection{Накат волны на берег и эффект <<мокрого песка>>}\label{wetsand}
Разработчики Skyforge \cite{skyforge} предложили следующий метод создания эффекта мокрого песка 
и смешивание его с накатывающими волнами: вблизи берега поверхность воды приподнимается 
над ландшафтом и при визуализации воды данные G-буфера нужным образом модифицируются. В частности, песок затемняется
и делается более зеркальным. Также полезно то, что в рамках одной визуализации несложно 
рассчитать смешения обоих эффектов (пены прибоя и мокрого песка).
