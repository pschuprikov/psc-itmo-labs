\section{Постановка задачи}
\label{problem_statement}

На постановку задачи существенное влияние оказывает существующая инфраструктура коммерческой системы
визуализации \emph{Frigate}, в рамках которой, поставленная задача должна быть решена.

\subsection{Модель водной поверхности}
Основным элементом инфраструктуры, с котором придется взаимодействовать, является 
модель водной поверхности. Данная модель представляет собой карту высот, построенную с помощью 
суммирования небольшого числа (около десяти) периодических функций двух аргументов 
(координаты без высоты). Если опустить незначительные отличия данной реализации, то каждая 
периодическая функция является т. н. волной Герстнера (англ.~Gerstner wave):
$$
\begin{array}{ccl}
    \bvec{x} & = & \bvec{x_0} - (\bvec{k} / ||k||)  A \sin(\bvec{k} \cdot \bvec{x} - \omega t)\\
    h & = & A \cos(\bvec{k} \cdot \bvec{x_0} - \omega t).
\end{array}
$$
Пример использования подобных волн можно найти в работе \cite{tessendorf} и множестве других, 
из которых можно выделить работу \cite{mixed}, совмещающую данную модель и реально наблюдаемые 
в природе спектральные характеристики водной поверхности.

Полученная описанным способом карта высот визуализируется с использованием техники проективной сетки
, подробное описание которой можно найти в работе \cite{projected}. 

Стоит также отметить, что несмотря на то, что данная модель используется и для штормовых 
погодных условий, в данной работе, как уже было сказано во введении, погодные условия 
предполагаются спокойными с незначительными волнениями.

\subsection{Ландшафт и система освещения}
Никаких особенных ограничений на визуализацию ландшафта не накладывается, однако предполагается 
возможным использовать, приближенный полигоном, контур береговой линии, 
приблизительно соответствующий реальной высоте ландшафта и уровню моря.

Стоит уделить особое внимание системе освещения, а именно в системе \emph{Frigate} используется 
метод, известный как \emph{отложенное освещение} (англ.~deferred shading), подробную информацию 
о котором можно найти в работах \cite{deferred,starcraft}. В данной методе, все необходимые для 
освещения данные о визуализируемых объектах сохраняются в специальной экранной структуре, 
называемой G-буфером (англ.~G-buffer). Примерами таких данных могут служить: нормаль к поверхности
($\mathbf{N}$), коэффициент диффузного отражение ($\mathbf{D}$), коэффициент зеркального 
отражения ($\mathbf{S}$), степень зеркального отражения ($S_\mathrm{pow}$), глубина и другие 
(зависит от реализации). Накопленные в G-буфере данные используются для расчета освещения 
всей сцены. Одной из наиболее простых и, одновременно, широко применяемых моделей освещения 
является модель Фонга (англ.~Phong), обозначая за $\mathbf{C}$ интенсивность источника, 
а за $\mathbf{R}$ и $\mathbf{L}$ --- направления отраженного света и на источник света соответственно,
наконец, обозначим за $\mathbf{A}$ --- окружающий свет, формула принимает такой вид:
$$
    \mathbf{Color} = \mathbf{D} \mathbf{A} + \mathbf{C} \max \{ \mathbf{N} \cdot \mathbf{L}, 0\} + 
    \mathbf{S} \mathbf{C} \max \{\mathbf{R} \cdot \mathbf{L}, 0 \}^{S_\mathrm{pow}}
$$

\subsection{Постановка задачи}
Рассмотрев окружение в котором предстоит работать, перейдем теперь к постановке задачи. 
Итак, требуется разработать систему, реализующую комплекс эффектов, порожденных прибрежными
волнами в прибрежных зонах. Данный комплекс эффектов включает:
\begin{enumerate}
\item \b{Эффект прибоя.} При приближении прибрежной волны к берегу, нижние слои воды 
испытывают существенное трение и заметно замедляются относительно верхних слоев, что приводит 
к обрушению гребня и образования пены, которую иногда называют \emph{барашками}. 
Эта пена представляет собой множество пузырьков воздуха на поверхности воды, образующихся 
из-за специфичных примесей и перемешивания воды и воздуха \cite{foam}.
\item \b{Накат прибрежной волны на берег.} Подходя к берегу, бурлящий гребень волны продолжает
движение, уводя с собой на берег некоторое количество пены и воды, которые спустя некоторое время 
откатывают обратно навстречу следующему гребню.
\item \b{Эффект <<мокрого песка>>.} Накатившая на берег вода впитывается в прибрежный песок,
и меняет отражающие свойства материала песчинок. Как результат, мы наблюдаем потемнение и 
блеск песка.
\end{enumerate}

Каждый из перечисленных эффектов необходимо реализовать таким образом, чтобы их визуальные 
характеристики оставались на хорошем уровне при рассмотрении как с ближнего, так и с дальнего планов.

Длина наблюдаемой береговой линии может составлять десятки километров, расстояние, с которого 
начинает проявляться эффект прибоя --- приблизительно 400 метров. Поэтому требуется с опаской
относиться к использованию структур данных, размер которых пропорциональных площади эффектов. 

Для сложных приложений виртуальной реальности, состоящих из множества компонент,
время работы и объем используемой памяти, особенно памяти графического процессора, и особенно
время работы центрального процессора, для одного отдельного эффекта должны быть минимизированы.